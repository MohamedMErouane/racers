name: racers
services:
  # Docker-based service (racers1)
  - name: racers-docker
    dockerfile_path: Dockerfile
    run_command: node server.js
    instance_count: 1
    instance_size_slug: basic-xxs
    http_port: 3001
    build_args:
      - key: PRIVY_APP_ID
        value: cmfq86fx6005yk10cfyapbkjk
      - key: APP_URL
        value: https://starfish-app-qqr68.ondigitalocean.app
    envs:
      - key: PORT
        value: "3001"
        scope: RUN_AND_BUILD
      - key: NODE_ENV
        value: production
        scope: RUN_AND_BUILD
      - key: APP_URL
        value: https://starfish-app-qqr68.ondigitalocean.app
        scope: RUN_AND_BUILD
      - key: DATABASE_URL
        value: ${dev-db-132655.DATABASE_URL}
        scope: RUN
      - key: PRIVY_APP_ID
        value: cmfq86fx6005yk10cfyapbkjk
        scope: RUN_AND_BUILD
      - key: PRIVY_APP_SECRET
        value: 4D8y2LKFWjM7ckDmC3merA94XfkRJnejL3o6cxG8cfVcNNmY9amTQxivjUe3YGusSgFEcUPjcp6K19kiMQgnewpk
        scope: RUN
      - key: PRIVY_JWKS_URL
        value: https://auth.privy.io/api/v1/apps/cmfq86fx6005yk10cfyapbkjk/jwks.json
        scope: RUN
      - key: JWT_SECRET
        value: test-jwt-secret-for-development-only
        scope: RUN
      - key: CORS_ORIGIN
        value: https://starfish-app-qqr68.ondigitalocean.app
        scope: RUN
      - key: SOLANA_RPC_URL
        value: https://api.devnet.solana.com
        scope: RUN
      - key: SOLANA_WS_URL
        value: wss://api.devnet.solana.com
        scope: RUN
      - key: PROGRAM_ID
        value: RacersFun1111111111111111111111111111111111
        scope: RUN
      - key: RACE_DURATION_MS
        value: "12000"
        scope: RUN
      - key: RACE_SETTLE_MS
        value: "2000"
        scope: RUN
      - key: RACE_COUNTDOWN_MS
        value: "10000"
        scope: RUN
      - key: HOUSE_EDGE_PERCENT
        value: "4"
        scope: RUN
      - key: WINNER_PAYOUT_PERCENT
        value: "86"
        scope: RUN
      - key: RAKEBACK_PERCENT
        value: "10"
        scope: RUN

  # Source-based service (racers2) â€” optional if you want to keep both
  # Uncomment if you have both services configured
  # - name: racers-source
  #   github:
  #     repo: MohamedMErouane/racers
  #     branch: main
  #   build_command: npm run build
  #   run_command: npm start
  #   instance_count: 1
  #   instance_size_slug: basic-xxs
  #   http_port: 3001
  #   envs:
  #     - key: PRIVY_APP_ID
  #       value: cmfq86fx6005yk10cfyapbkjk
  #       scope: RUN_AND_BUILD
  #     - key: WS_URL
  #       value: ws://localhost:3001
  #       scope: RUN_AND_BUILD
  #     - key: API_URL
  #       value: http://localhost:3001/api
  #       scope: RUN_AND_BUILD
  #     - key: DATABASE_URL
  #       value: ${dev-db-132655.DATABASE_URL}
  #       scope: RUN
  #     - key: PRIVY_APP_SECRET
  #       value: 4D8y2LKFWjM7ckDmC3merA94XfkRJnejL3o6cxG8cfVcNNmY9amTQxivjUe3YGusSgFEcUPjcp6K19kiMQgnewpk
  #       scope: RUN
  #     - key: CORS_ORIGIN
  #       value: http://localhost:3001,https://racer-ghw7utxdp-mohamedmerouanes-projects.vercel.app
  #       scope: RUN

databases:
  - name: dev-db-132655
    engine: PG
    version: "14"
    production: false
